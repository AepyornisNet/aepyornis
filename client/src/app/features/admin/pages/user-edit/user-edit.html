<div class="container my-5" style="max-width: 600px">
  <h2 class="display-6 mb-4 d-flex align-items-center gap-2">
    <app-icon name="settings" size="32" />
    @if (user()) {
      Manage user: {{ user()!.name }}
    } @else {
      Edit User
    }
  </h2>

  @if (error()) {
    <div class="alert alert-danger" role="alert">
      {{ error() }}
    </div>
  }

  @if (loading()) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  } @else if (user()) {
    <div class="card shadow-sm">
      <div class="card-body">
        <form [formGroup]="userForm" (ngSubmit)="saveUser()">
          <!-- Username -->
          <div class="mb-3">
            <label class="form-label" for="username"> Username </label>
            <input
              class="form-control"
              formControlName="username"
              id="username"
              required
              type="text"
            />
          </div>

          <!-- Name -->
          <div class="mb-3">
            <label class="form-label" for="name"> Name </label>
            <input class="form-control" formControlName="name" id="name" required type="text" />
          </div>

          <!-- Password -->
          <div class="mb-3">
            <label class="form-label" for="password"> Password </label>
            <input
              class="form-control"
              formControlName="password"
              id="password"
              placeholder="Leave blank to keep current password"
              type="password"
            />
          </div>

          <!-- Active -->
          <div class="mb-3 form-check">
            <input class="form-check-input" formControlName="active" id="active" type="checkbox" />
            <label class="form-check-label" for="active"> Active </label>
          </div>

          <!-- Admin -->
          <div class="mb-3 form-check">
            <input class="form-check-input" formControlName="admin" id="admin" type="checkbox" />
            <label class="form-check-label" for="admin"> Admin </label>
          </div>

          <!-- Actions -->
          <div class="d-flex gap-2 pt-3">
            <button class="btn btn-primary" type="submit" [disabled]="saving() || userForm.invalid">
              @if (saving()) {
                <span
                  aria-hidden="true"
                  class="spinner-border spinner-border-sm me-2"
                  role="status"
                ></span>
                Saving...
              } @else {
                Update user
              }
            </button>
            <a class="btn btn-secondary" routerLink="/admin"> Cancel </a>
          </div>
        </form>
      </div>
    </div>
  }
</div>
